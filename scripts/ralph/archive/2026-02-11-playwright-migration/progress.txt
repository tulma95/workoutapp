# Ralph Progress Log
Started: Tue Feb 11 2026
---

## Codebase Patterns
- Backend stores weights in kg internally, converts to user's preferred unit at API layer
- Use `convertWeightToUserUnit()` helper in services to convert from kg to user's unit
- Use `roundWeight()` from lib/weightRounding.ts for rounding (2.5kg or 5lb increments)
- Always look up user.unitPreference before returning weights to frontend
- Frontend receives weights already in user's unit - no conversion needed on frontend
- For input (user â†’ backend), convert from user's unit to kg for storage
- Frontend pages use `useAuth().user.unitPreference` to display unit suffix
- All touch targets must be at least 44px height (use `min-height: 44px` in CSS)
- Input name attributes must match E2E test selectors (e.g., input[name='bench'])
- Use `btn-primary` class for primary action buttons
- Form validation: check for positive numbers before API calls

---

## 2026-02-11 20:15 - US-044
- Verified backend unit conversion implementation is complete
- Files already modified (in previous commits):
  - backend/src/services/trainingMax.service.ts - added convertWeightToUserUnit()
  - backend/src/services/workout.service.ts - added formatWorkout() helper
- **Learnings for future iterations:**
  - The unit conversion was implemented earlier in the branch history
  - All training max endpoints (GET, POST setup, PATCH, GET history) return weights in user's unit
  - All workout endpoints (POST, GET current, GET by ID, complete) return weights in user's unit
  - Backend tests cover both kg and lb users with proper conversion assertions
  - LB_TO_KG constant = 2.20462 used throughout for conversions
  - All 133 backend tests passing, typecheck passes
---

## 2026-02-11 20:17 - US-045
- Verified training max API module and hook are implemented
- Files created:
  - frontend/src/api/trainingMaxes.ts - API functions for TM operations
  - frontend/src/hooks/useTrainingMaxes.ts - React hook for fetching TMs
- **Learnings for future iterations:**
  - API module follows same pattern as api/auth.ts - uses apiFetch helper
  - Hook uses useState + useEffect pattern for data fetching
  - Weight values from backend are already in user's preferred unit
  - TrainingMax interface includes: id, userId, exercise, weight, effectiveDate, createdAt
  - OneRepMaxes interface for setup: { bench, squat, ohp, deadlift }
  - Hook exposes: { trainingMaxes, isLoading, error, refetch }
  - Frontend typecheck passes
---

## 2026-02-11 20:19 - US-046
- Verified setup page is fully implemented
- Files created:
  - frontend/src/pages/SetupPage.tsx - Full setup page implementation
  - frontend/src/pages/SetupPage.css - Styling with proper touch targets
- **Learnings for future iterations:**
  - Setup page uses useAuth() to get user.unitPreference for display
  - Form has 4 labeled number inputs with name attributes: bench, squat, ohp, deadlift
  - Client-side validation checks all fields are positive numbers before submit
  - Uses setupTrainingMaxes() from api/trainingMaxes.ts
  - Redirects to dashboard (/) on success using useNavigate()
  - Shows loading state and error messages
  - All touch targets are 44px height (inputs and button)
  - Form state managed with useState, validation runs on submit
  - Frontend typecheck passes
---
